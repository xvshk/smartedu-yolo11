# è¯¾å ‚è¡Œä¸ºæ£€æµ‹ç³»ç»Ÿ - åç«¯æ¶æ„

## è½¯ä»¶åˆ†å±‚æ¶æ„

æœ¬é¡¹ç›®é‡‡ç”¨æ··åˆåˆ†å±‚æ¶æ„ï¼Œç»“åˆäº† **MVC åˆ†å±‚**ï¼ˆç®¡ç†ç³»ç»Ÿéƒ¨åˆ†ï¼‰å’Œ **AI æ¨¡å—åˆ†å±‚**ï¼ˆçº¯ AI åŠŸèƒ½ï¼‰ã€‚

### ğŸ—ï¸ ç›®å½•ç»“æ„

```
backend/
â”œâ”€â”€ controller/         # æ§åˆ¶å±‚ (MVC) - è·¯ç”±å’ŒAPIæ¥å£
â”œâ”€â”€ service/           # ä¸šåŠ¡å±‚ (MVC) - ä¸šåŠ¡é€»è¾‘å¤„ç†
â”œâ”€â”€ module/            # æŒä¹…å±‚ (MVC) - æ•°æ®è®¿é—®å’ŒåŸºæœ¬ç±»
â”œâ”€â”€ presentation/      # è¡¨ç°å±‚ (AI) - CLIå’Œç”¨æˆ·äº¤äº’
â”‚   â”œâ”€â”€ cli/          # å‘½ä»¤è¡Œæ¥å£
â”‚   â”‚   â”œâ”€â”€ train_cli.py           # æ¨¡å‹è®­ç»ƒCLI
â”‚   â”‚   â”œâ”€â”€ train_optimized_cli.py # RTX 4050ä¼˜åŒ–è®­ç»ƒCLI
â”‚   â”‚   â”œâ”€â”€ evaluate_cli.py        # æ¨¡å‹è¯„ä¼°CLI
â”‚   â”‚   â””â”€â”€ detection_cli.py       # æ£€æµ‹CLI
â”‚   â””â”€â”€ gui/          # å›¾å½¢ç”¨æˆ·ç•Œé¢
â”‚       â””â”€â”€ pyside6_app.py         # PySide6æ¡Œé¢åº”ç”¨
â”œâ”€â”€ business/          # ä¸šåŠ¡å±‚ (AI) - æ ¸å¿ƒAIä¸šåŠ¡é€»è¾‘
â”œâ”€â”€ foundation/        # åŸºç¡€å±‚ (AI) - åŸºç¡€å·¥å…·å’Œæ•°æ®å¤„ç†
â”œâ”€â”€ ml/               # MLOpsæ¨ªå‘æ”¯æ’‘ - æ¨¡å‹ç®¡ç†å’Œè¿½è¸ª
â””â”€â”€ runs/             # è®­ç»ƒè¾“å‡ºå’Œç»“æœ
```

## ğŸ“‹ å„å±‚èŒè´£

### MVC åˆ†å±‚ï¼ˆç®¡ç†ç³»ç»Ÿï¼‰

#### Controller å±‚ (æ§åˆ¶å±‚)
- **èŒè´£**: è·¯ç”±å¤„ç†ã€APIæ¥å£ã€è¯·æ±‚å“åº”
- **æ–‡ä»¶**: `controller/*.py`
- **ç‰¹ç‚¹**: åªåšç”¨æˆ·è¯·æ±‚çš„æ¥æ”¶å’Œå“åº”ï¼Œä¸åŒ…å«ä¸šåŠ¡é€»è¾‘

#### Service å±‚ (ä¸šåŠ¡å±‚)
- **èŒè´£**: ä¸šåŠ¡é€»è¾‘å¤„ç†ã€æ•°æ®éªŒè¯ã€ä¸šåŠ¡è§„åˆ™
- **æ–‡ä»¶**: `service/*.py`
- **ç‰¹ç‚¹**: æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œè°ƒç”¨æŒä¹…å±‚è·å–æ•°æ®

#### Module å±‚ (æŒä¹…å±‚)
- **èŒè´£**: æ•°æ®è®¿é—®ã€æ•°æ®åº“æ“ä½œã€åŸºæœ¬æ•°æ®ç±»
- **æ–‡ä»¶**: `module/*.py`
- **ç‰¹ç‚¹**: çº¯æ•°æ®æ“ä½œï¼Œä¸åŒ…å«ä¸šåŠ¡é€»è¾‘

### AI æ¨¡å—åˆ†å±‚

#### Presentation å±‚ (è¡¨ç°å±‚)
- **èŒè´£**: CLIå‚æ•°è§£æã€ç”¨æˆ·äº¤äº’ã€ç¨‹åºå…¥å£ã€GUIç•Œé¢
- **æ–‡ä»¶**: `presentation/*.py`
- **ç‰¹ç‚¹**: åªåšç”¨æˆ·/å¤–éƒ¨å¯¹æ¥ï¼Œä¸ç¢°æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
- **åŒ…å«**:
  - CLI å‘½ä»¤è¡Œæ¥å£ (`cli/`)
    - `train_cli.py` - æ¨¡å‹è®­ç»ƒå‘½ä»¤è¡Œå·¥å…·
    - `train_optimized_cli.py` - RTX 4050ä¼˜åŒ–è®­ç»ƒå·¥å…·
    - `evaluate_cli.py` - æ¨¡å‹è¯„ä¼°å‘½ä»¤è¡Œå·¥å…·
    - `detection_cli.py` - æ£€æµ‹å‘½ä»¤è¡Œå·¥å…·
  - GUI å›¾å½¢ç•Œé¢ (`gui/`)
    - `pyside6_app.py` - PySide6æ¡Œé¢åº”ç”¨
  - ç”¨æˆ·è¾“å…¥å¤„ç†
  - ç»“æœè¾“å‡ºå±•ç¤º

#### Business å±‚ (ä¸šåŠ¡å±‚)
- **èŒè´£**: æµç¨‹æ•´åˆã€å¤šæ¨¡å—åè°ƒã€æ ¸å¿ƒAIé€»è¾‘
- **æ–‡ä»¶**: `business/*.py`
- **ç‰¹ç‚¹**: é¡¹ç›®æ ¸å¿ƒé€»è¾‘ï¼Œæ— ç”¨æˆ·äº¤äº’
- **åŒ…å«**:
  - æ¨¡å‹è®­ç»ƒæµæ°´çº¿
  - æ¨¡å‹è¯„ä¼°æ¨¡å—
  - æ¨ç†æ¨¡å—
  - ä»»åŠ¡è°ƒåº¦

#### Foundation å±‚ (åŸºç¡€å±‚)
- **èŒè´£**: çº¯å·¥å…·/çº¯åŸºç¡€èƒ½åŠ›ï¼Œæ— ä¸šåŠ¡é€»è¾‘
- **æ–‡ä»¶**: `foundation/*.py`
- **ç‰¹ç‚¹**: å•ä¸€èŒè´£çš„åŸºç¡€å·¥ä½œ
- **åŒ…å«**:
  - æ•°æ®é¢„å¤„ç†
  - æ•°æ®æ¸…æ´—
  - é…ç½®æ–‡ä»¶è¯»å–
  - æ—¥å¿—è®°å½•
  - é€šç”¨å·¥å…·å‡½æ•°

### MLOps æ¨ªå‘æ”¯æ’‘
- **èŒè´£**: è´¯ç©¿ä¸‰å±‚çš„æ¨ªå‘æ”¯æ’‘ä½“ç³»
- **æ–‡ä»¶**: `ml/*.py`
- **ç‰¹ç‚¹**: ä¸ºæ·±åº¦å­¦ä¹ å…¨ç”Ÿå‘½å‘¨æœŸæä¾›å·¥ç¨‹åŒ–ç®¡ç†
- **åŒ…å«**:
  - æ¨¡å‹ç‰ˆæœ¬ç®¡ç†
  - å®éªŒè¿½è¸ª
  - æ¨¡å‹éƒ¨ç½²æ”¯æŒ

## ğŸš€ ä½¿ç”¨æ–¹å¼

### Web API æœåŠ¡
```bash
# å¯åŠ¨ Flask åº”ç”¨
python -m backend.app
```

### CLI å·¥å…·
```bash
# æ¨¡å‹è®­ç»ƒ
python backend/presentation/cli/train_cli.py --data ./data/dataset.yaml --epochs 100

# RTX 4050 ä¼˜åŒ–è®­ç»ƒ
python backend/presentation/cli/train_optimized_cli.py --data ./data/dataset.yaml --preset performance

# æ¨¡å‹è¯„ä¼°
python backend/presentation/cli/evaluate_cli.py --weights ./runs/best.pt --data ./data/test.yaml

# æ£€æµ‹åŠŸèƒ½
python backend/presentation/cli/detection_cli.py --source ./images/test.jpg --model ./runs/best.pt
```

### GUI åº”ç”¨
```bash
# å¯åŠ¨ PySide6 æ¡Œé¢åº”ç”¨
python backend/presentation/gui/pyside6_app.py
```

## ğŸ“¦ ä¸»è¦ç»„ä»¶

### API è“å›¾
- `auth` - ç”¨æˆ·è®¤è¯
- `user` - ç”¨æˆ·ç®¡ç†
- `detection` - æ£€æµ‹åŠŸèƒ½
- `alert` - é¢„è­¦ç®¡ç†
- `notification` - é€šçŸ¥ç³»ç»Ÿ
- `dashboard` - ä»ªè¡¨æ¿
- `portrait` - å­¦ç”Ÿç”»åƒ
- `settings` - ç³»ç»Ÿè®¾ç½®

### AI åŠŸèƒ½æ¨¡å—
- **è®­ç»ƒæµæ°´çº¿**: YOLOv11 æ¨¡å‹è®­ç»ƒ
- **æ¨¡å‹è¯„ä¼°**: æ€§èƒ½æŒ‡æ ‡è®¡ç®—å’ŒæŠ¥å‘Š
- **æ•°æ®å¤„ç†**: æ•°æ®æ¸…æ´—å’Œé¢„å¤„ç†
- **é…ç½®ç®¡ç†**: è¡Œä¸ºç±»åˆ«å’Œå‚æ•°é…ç½®

## ğŸ“‹ æ¸…ç†å®ŒæˆçŠ¶æ€

âœ… **å·²å®Œæˆçš„å·¥ä½œ**:
- åˆ é™¤äº† `src/` ç›®å½•ä¸­çš„æ‰€æœ‰é‡å¤æ–‡ä»¶
- æ‰€æœ‰æ–‡ä»¶å·²æŒ‰è½¯ä»¶åˆ†å±‚è¦æ±‚æ­£ç¡®åˆ†é…åˆ°å…­ä¸ªæ–‡ä»¶å¤¹
- æ›´æ–°äº†æ‰€æœ‰å¯¼å…¥è·¯å¾„ï¼Œç¡®ä¿å¼•ç”¨æ­£ç¡®çš„æ¨¡å—ä½ç½®
- éªŒè¯äº† Flask åº”ç”¨å’Œ CLI å·¥å…·æ­£å¸¸å·¥ä½œ

âœ… **æ–‡ä»¶åˆ†é…ç»“æœ**:
- **Foundation å±‚**: `src/config/` å’Œ `src/data/` â†’ `backend/foundation/`
- **Business å±‚**: `src/training/` å’Œ `src/evaluation/` â†’ `backend/business/`  
- **Module å±‚**: `src/database/` â†’ `backend/module/`
- **Controller å±‚**: `backend/api/` â†’ `backend/controller/` (å·²å®Œæˆ)
- **Service å±‚**: `backend/services/` â†’ `backend/service/` (å·²å®Œæˆ)
- **Presentation å±‚**: 
  - `scripts/train.py` â†’ `backend/presentation/cli/train_cli.py`
  - `scripts/train_optimized_4050.py` â†’ `backend/presentation/cli/train_optimized_cli.py`
  - `scripts/evaluate_model.py` â†’ `backend/presentation/cli/evaluate_cli.py`
  - `desktop/pyside6.py` â†’ `backend/presentation/gui/pyside6_app.py`

âœ… **åˆ é™¤çš„é‡å¤æ–‡ä»¶**: 27 ä¸ªé‡å¤æ–‡ä»¶å·²æ¸…ç†ï¼ˆåŒ…æ‹¬æ¨¡å‹è®­ç»ƒè„šæœ¬å’ŒPySide6åº”ç”¨ï¼‰
âœ… **ç³»ç»ŸéªŒè¯**: Flask åº”ç”¨å’Œ CLI å·¥å…·å‡æ­£å¸¸è¿è¡Œ

## ğŸ”§ å¼€å‘æŒ‡å—
1. åœ¨ `controller/` ä¸­åˆ›å»ºæ–°çš„è“å›¾
2. åœ¨ `service/` ä¸­å®ç°ä¸šåŠ¡é€»è¾‘
3. åœ¨ `module/` ä¸­æ·»åŠ æ•°æ®è®¿é—®å±‚
4. åœ¨ `app.py` ä¸­æ³¨å†Œè“å›¾

### æ·»åŠ æ–°çš„ AI åŠŸèƒ½
1. åœ¨ `foundation/` ä¸­æ·»åŠ åŸºç¡€å·¥å…·
2. åœ¨ `business/` ä¸­å®ç°æ ¸å¿ƒé€»è¾‘
3. åœ¨ `presentation/` ä¸­æ·»åŠ ç”¨æˆ·æ¥å£
4. ä½¿ç”¨ `ml/` è¿›è¡Œæ¨¡å‹ç®¡ç†

### å¯¼å…¥è§„åˆ™
- Controller å±‚å¯ä»¥å¯¼å…¥ Service å±‚
- Service å±‚å¯ä»¥å¯¼å…¥ Module å±‚
- Business å±‚å¯ä»¥å¯¼å…¥ Foundation å±‚
- Presentation å±‚å¯ä»¥å¯¼å…¥ Business å±‚
- å„å±‚éƒ½å¯ä»¥ä½¿ç”¨ MLOps æ¨ªå‘æ”¯æ’‘

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **ä¸¥æ ¼åˆ†å±‚**: ä¸å…è®¸è·¨å±‚è°ƒç”¨ï¼Œå¿…é¡»æŒ‰å±‚çº§é¡ºåºè°ƒç”¨
2. **å•ä¸€èŒè´£**: æ¯å±‚åªè´Ÿè´£è‡ªå·±çš„èŒè´£ï¼Œä¸è¶Šç•Œå¤„ç†å…¶ä»–å±‚çš„é€»è¾‘
3. **å¯¼å…¥è·¯å¾„**: ä½¿ç”¨æ­£ç¡®çš„å¯¼å…¥è·¯å¾„ï¼Œé¿å…å¾ªç¯å¯¼å…¥
4. **é”™è¯¯å¤„ç†**: åœ¨é€‚å½“çš„å±‚çº§è¿›è¡Œé”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
5. **æµ‹è¯•è¦†ç›–**: ä¸ºæ¯å±‚ç¼–å†™ç›¸åº”çš„å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•